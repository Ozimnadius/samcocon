"use strict";function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var jsTools={getNumber:function(e){return parseInt(e.replace(/[^\d]/g,""))},getWindowWidth:function(){return document.documentElement.clientWidth},getNumberFormat:function(e,t,a,n){var o,i;return isNaN(t=Math.abs(t))&&(t=2),null==a&&(a=","),null==n&&(n="."),(i=(o=parseInt(e=(+e||0).toFixed(t))+"").length)>3?i%=3:i=0,(i?o.substr(0,i)+n:"")+o.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+n)+(t?a+Math.abs(e-o).toFixed(t).replace(/-/,0).slice(2):"")}},media={mobile:window.matchMedia("(max-width: 767.98px)"),tablet:window.matchMedia("(max-width: 1279.98px)"),note:window.matchMedia("(max-width: 1659.98px)")};window.addEventListener("load",(function(){$('.input[type="tel"]').inputmask("+7(999)999-99-99")}));var Template=function(){function e(){_classCallCheck(this,e),this.content=document.querySelector("#templates").content}return _createClass(e,[{key:"html",value:function(e){return this.content.querySelector("#".concat(e)).innerHTML}},{key:"close",value:function(){$.fancybox.close()}},{key:"open",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$.fancybox.open(this.html(e),t),$('.input[type="tel"]').inputmask("+7(999)999-99-99")}},{key:"current",get:function(){return $.fancybox.getInstance().current.$content}}]),e}(),template=new Template,Actions=function(){function e(t,a){_classCallCheck(this,e),this.validateForms=document.querySelectorAll("".concat(t,'[data-action="validate"]')),this.ajaxFormsSelector="".concat(t,'[data-action="openAjaxForm"]'),this.templateFormsSelector="".concat(t,'[data-action="openForm"]'),this.init()}return _createClass(e,[{key:"init",value:function(){var e=this;this.validateForms.forEach((function(t){return e.validate(t)})),window.addEventListener("click",(function(t){t.target.closest(e.ajaxFormsSelector)&&(t.preventDefault(),e.openAjaxForm(t.target.closest(e.ajaxFormsSelector).dataset)),t.target.closest(e.templateFormsSelector)&&(t.preventDefault(),e.openTemplateForm(t.target.closest(e.templateFormsSelector).dataset))}))}},{key:"validate",value:function(e){$(e).validate({submitHandler:function(e){$(e).serialize();var t=new FormData(e);$.ajax({dataType:"json",type:"POST",url:e.action,data:t,cache:!1,contentType:!1,processData:!1,success:function(t){t.status?(e.dataset.reset&&e.reset(),template.open(e.dataset.successForm)):alert("Что-то пошло не так, попробуйте еще раз!!!")},error:function(e){alert("Что-то пошло не так, попробуйте еще раз!!!")}})},invalidHandler:function(e,t){},errorPlacement:function(e,t){t[0].placeholder=e[0].innerText}})}},{key:"current",get:function(){return template.current}},{key:"openAjaxForm",value:function(e){$.ajax({dataType:"json",type:"POST",url:e.ajax,data:{id:e.id},success:function(e){e.status?(template.close(),$.fancybox.open(e.html)):alert("Что-то пошло не так, попробуйте еще раз!!!")},error:function(e){alert("Что-то пошло не так, попробуйте еще раз!!!")}})}},{key:"openTemplateForm",value:function(e){this.openForm(e.form),e.msg&&this.current.find("textarea").val(e.msg).addClass("input--y"),this.current.validate({submitHandler:function(t){var a=$(t).serialize();$.ajax({dataType:"json",type:"POST",url:"/php/ajax.php",data:a,success:function(t){t.status?(template.close(),template.open(e.successForm)):alert("Что-то пошло не так, попробуйте еще раз!!!")},error:function(e){alert("Что-то пошло не так, попробуйте еще раз!!!")}})},invalidHandler:function(e,t){},errorPlacement:function(e,t){t[0].placeholder=e[0].innerText}})}},{key:"openForm",value:function(e){template.open(e)}}]),e}();window.addEventListener("load",(function(){new Actions(".jsAction")}));var Tabs=function(){function e(t){var a=this;_classCallCheck(this,e),_defineProperty(this,"click",(function(e){e.preventDefault(),a.deactivate(),a.activeIndex=a.getIndex(e.currentTarget),a.activate()})),this.hash=t,this.tabs=document.querySelector(".jsTabs"),this.btnsList=this.tabs.querySelectorAll(".jsTabs__btn"),this.tabsList=this.tabs.querySelectorAll(".jsTabs__tab"),this.activeIndex=0,this.init()}return _createClass(e,[{key:"init",value:function(){var e=this;this.activeIndex=this.getIndex(this.tabs.querySelector('[href="'+this.hash+'"]')),this.activate(),this.btnsList.forEach((function(t){return t.addEventListener("click",e.click)}))}},{key:"getIndex",value:function(e){return Array.from(this.btnsList).indexOf(e)}},{key:"deactivate",value:function(){this.btnsList[this.activeIndex].classList.remove("active"),this.tabsList[this.activeIndex].classList.remove("active")}},{key:"activate",value:function(){this.btnsList[this.activeIndex].classList.add("active"),this.tabsList[this.activeIndex].classList.add("active")}}]),e}();function animations(){gsap.fromTo(".spark__sub",{x:-200,opacity:0},{x:0,opacity:1,duration:2}),gsap.fromTo(".spark__txt",{y:500,opacity:0},{y:0,opacity:1,duration:2.1}),gsap.timeline().fromTo(".spark__title-text",{y:200,opacity:0},{y:0,opacity:1,duration:2}).fromTo(".spark__btn",{y:200,opacity:0},{y:0,opacity:1,duration:1.3},"-=1.7").to(".spark__title-line",{x:0,duration:1.5},"-=1.5").fromTo(".spark-statue__img",{y:100},{y:0,duration:2},"-=1.5");var e=$(".spark"),t=-.01,a=null,n={x:0,y:0},o=window.innerWidth/2,i=window.innerHeight/2;function r(){var e=n.x-o,t=(n.y-i)/i,a=-e/o,r=20*Math.sqrt(Math.pow(t,2)+Math.pow(a,2));gsap.to(".spark__bg",.5,{transform:"rotate3d("+t+", "+a+", 0, "+r+"deg)",ease:Power2.easeOut})}e.on("mousemove",(function(o){var i=o.pageX-.5*e.width(),s=o.pageY-.5*e.height();gsap.to(".spark-planet__star",.5,{x:2*i*t,y:4*s*t,ease:Power1.easeOut}),gsap.to(".spark-planet__img",.5,{x:4*i*t,y:4*s*t,ease:Power1.easeOut}),gsap.to(".spark-statue",1,{x:.5*i*t,y:.5*s*t,ease:Power1.easeOut}),gsap.to(".spark__stars",.5,{x:-1*i*t,y:-2*s*t,ease:Power1.easeOut}),gsap.to(".spark__planet-small",.5,{x:-2*i*t,y:-4*s*t,ease:Power1.easeOut}),n.x=o.pageX,n.y=o.pageY,cancelAnimationFrame(a),a=requestAnimationFrame(r)}))}window.addEventListener("load",(function(){if(!media.tablet.matches){gsap.to(".spark__bg img",{x:"-50%",ease:"none",duration:10,repeat:-1}),gsap.to(".spark-statue__svg svg",5,{rotation:360,repeat:-1,transformOrigin:"50% 50%",ease:Linear.easeNone}),setTimeout(animations,1e3);gsap.fromTo(".spark-planet__star",{x:60,y:40,opacity:1},{x:0,y:0,opacity:1,duration:.7},1),gsap.fromTo(".spark__stars",{x:-40,y:-60,opacity:1},{x:0,y:0,opacity:1,duration:.7},1)}})),window.addEventListener("load",(function(){if(!media.tablet.matches){var e=gsap.timeline({scrollTrigger:{trigger:".plans",scrub:1,ease:"none",start:"100px bottom",end:"top 60%"}});gsap.utils.toArray(".plans__item").forEach((function(t){e.fromTo(t,{y:"100%",opacity:0},{y:0,opacity:1})}))}(document.querySelectorAll(".jsPlanOpen").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation();var t={};isMobile.apple.device&&(t={afterShow:function(e,t){setTimeout((function(){t.$content[0].parentElement.scrollTo({top:0})}),100)}}),template.open("info",t),new Tabs(this.hash)}))})),media.tablet.matches)&&document.querySelectorAll(".jsPlanFlip").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),this.closest(".plan").classList.toggle("flip")}))}))})),window.addEventListener("load",(function(){if(isMobile.apple.tablet&&document.querySelector(".scroll").classList.add("apple"),!media.tablet.matches){var e=document.querySelectorAll(".scroll__section"),t=window.innerWidth,a=(gsap.utils.toArray(".scroll__section"),e[e.length-1].offsetLeft),n=e[e.length-1].offsetWidth-(t-a),o=600;media.note.matches&&(o=200),isMobile.apple.tablet||gsap.to(".scroll__wrap",{x:-(n+o),ease:"none",scrollTrigger:{trigger:".scroll",pin:".scroll",scrub:1,start:"top top",end:function(){return"+="+document.querySelector(".scroll__wrap").offsetWidth}}})}})),window.addEventListener("load",(function(){if(!media.tablet.matches){var e=gsap.timeline({scrollTrigger:{trigger:".diffs__cols",scrub:1,ease:"none",start:"top 90%",end:"top 80%"}});gsap.utils.toArray(".diffs__col").forEach((function(t){e.fromTo(t,{y:"50px",opacity:0},{y:0,opacity:1})}))}})),window.addEventListener("load",(function(){media.tablet.matches||gsap.utils.toArray(".jsAnimate").forEach((function(e){var t,a=e.dataset,n=JSON.parse(a.from),o=JSON.parse(a.to),i=null!==(t=a.trigger)&&void 0!==t?t:e;gsap.timeline({scrollTrigger:{trigger:i,scrub:1,ease:"none",start:a.start,end:a.end,markers:a.markers}}).fromTo(e,n,o)}))})),window.addEventListener("load",(function(){$(".jsMenuOpen").on("click",(function(){$(".aside").addClass("open")})),document.addEventListener("click",(function(e){var t=e.target;t.closest(".aside")||t.closest(".jsMenuOpen")?t.closest(".jsMenuClose")&&$(".aside").removeClass("open"):$(".aside").removeClass("open")}))})),window.addEventListener("load",(function(){gsap.utils.toArray(".jsSection").forEach((function(e,t){ScrollTrigger.create({start:"top center",end:"bottom center",trigger:e,onLeave:function(){document.querySelector('.nav__item[href="#'+e.id+'"]').classList.remove("active")},onLeaveBack:function(){document.querySelector('.nav__item[href="#'+e.id+'"]').classList.remove("active")},onEnter:function(){document.querySelector('.nav__item[href="#'+e.id+'"]').classList.add("active")},onEnterBack:function(){document.querySelector('.nav__item[href="#'+e.id+'"]').classList.add("active")}})}));var e=0,t=.02;media.tablet.matches&&(t=.3),media.mobile.matches&&(e=110),gsap.utils.toArray(".nav__item").forEach((function(a){a.addEventListener("click",(function(a){a.preventDefault(),gsap.to(window,{duration:t,scrollTo:{y:this.hash,offsetY:e}}),$(".aside").removeClass("open")}))}))}));
//# sourceMappingURL=script.js.map